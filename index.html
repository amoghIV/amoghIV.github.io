<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pantheon • Immersive Tour</title>

<!-- Performance -->
<link rel="preconnect" href="https://upload.wikimedia.org" crossorigin>
<link rel="preconnect" href="https://commons.wikimedia.org" crossorigin>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Great+Vibes&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#0b0c0f;
    --fg:#f2efe9;
    --muted:#cfc9bb;
    --accent:#e15b5b;
    --accent-2:#a33d3d;
    --panel:#15161c;
    --panel-alpha: rgba(20,21,27,.78);
    --border: rgba(255,255,255,.1);
    --shadow: 0 12px 40px rgba(0,0,0,.45);
    --radius:16px;
    --maxw:1120px;
    --panelw: min(520px, 92vw);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:var(--bg);color:var(--fg);
    font-family: "Cinzel", serif; -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    overflow:hidden;
  }

  /* HOME */
  #home{
    position:fixed; inset:0; display:grid; place-items:center;
    background:#000 url("https://commons.wikimedia.org/wiki/Special:FilePath/Pantheon%20and%20fountain%20at%20night.JPG?width=1920") center/cover no-repeat;
  }
  .home-overlay{position:absolute; inset:0; background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.65))}
  .home-card{
    position:relative; z-index:2; max-width:var(--maxw);
    background:var(--panel-alpha); border:1px solid var(--border);
    border-radius:var(--radius); padding:24px; box-shadow:var(--shadow);
    text-align:center;
  }
  .home-title{font-size:clamp(28px,4vw,56px); letter-spacing:.6px; margin:0 0 6px}
  .home-sub{opacity:.9; margin:0 0 18px}
  .mla{
    margin:16px auto 22px; display:inline-block; text-align:left; line-height:1.6;
    padding:12px 16px; background:rgba(255,255,255,.04); border-radius:10px; border:1px solid var(--border)
  }
  .home-btn{
    appearance:none; border:none; cursor:pointer;
    background:linear-gradient(180deg,var(--accent),var(--accent-2));
    color:#fff; padding:14px 22px; border-radius:12px; font-size:18px; font-weight:700;
    box-shadow:0 10px 30px rgba(225,91,91,.25);
    transition:transform .2s ease, box-shadow .2s ease, filter .2s ease;
  }
  .home-btn:hover{transform:translateY(-2px); filter:saturate(1.05); box-shadow:0 14px 32px rgba(225,91,91,.35)}
  .hint{margin-top:10px; font-size:14px; color:var(--muted); opacity:.9}

  /* APP */
  #app{position:fixed; inset:0; display:none; background:#000}

  .slide{
    position:absolute; inset:0; display:grid; grid-template-columns:1fr; grid-template-rows:1fr;
    background:#000 center/cover no-repeat;
    opacity:0; pointer-events:none;
    transition:opacity .6s ease;
    image-rendering:auto;
  }
  .slide.active{opacity:1; pointer-events:auto}
  .slide.fadeout{opacity:0}

  /* Panel placed to one side so the photo is visible */
  .panel{
    position:absolute; top:6%; bottom:6%;
    width:var(--panelw); padding:18px 18px 14px;
    background:var(--panel-alpha); border:1px solid var(--border); border-radius:16px;
    box-shadow: var(--shadow); overflow:auto;
  }
  .left{left:2.5%}
  .right{right:2.5%}

  /* Video slide background */
  .vid-wrap{position:absolute; inset:0; overflow:hidden}
  .vid-wrap video{position:absolute; min-width:100%; min-height:100%; top:50%; left:50%; transform:translate(-50%,-50%); object-fit:cover; filter:contrast(1.08) saturate(1.05)}
  .vid-scrim{position:absolute; inset:0; background:radial-gradient(1100px 600px at 70% 60%,rgba(0,0,0,.1),rgba(0,0,0,.65) 60%, rgba(0,0,0,.9))}

  .title{font-size:clamp(22px,3vw,32px); margin:0 0 8px; color:#f0e6d2}
  .para{margin:6px 2px 8px; line-height:1.65; font-size:clamp(15px,1.4vw,18px)}
  .bullets{margin:8px 6px 4px 18px; padding:0}
  .bullets li{margin:8px 0; line-height:1.55; font-size:clamp(14px,1.3vw,17px)}

  .progress{
    position:fixed; top:10px; left:50%; transform:translateX(-50%);
    z-index:10; background:rgba(0,0,0,.45); padding:6px 12px; border-radius:999px; font-size:14px; border:1px solid var(--border)
  }
  .navbtn{
    position:fixed; top:50%; transform:translateY(-50%); z-index:8;
    width:46px; height:46px; border-radius:50%; border:1px solid rgba(255,255,255,.18);
    display:grid; place-items:center; background:rgba(0,0,0,.35); color:#fff; cursor:pointer;
    transition:transform .15s ease, background .2s ease; user-select:none;
  }
  .navbtn:hover{transform:translateY(-50%) scale(1.04); background:rgba(0,0,0,.45)}
  #prev{left:14px} #next{right:14px}
  @media (max-width:780px){ .navbtn{display:none} }

  /* Controls */
  .audio{
    position:fixed; left:12px; bottom:12px; z-index:12;
    background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12);
    color:#fff; padding:8px 12px; border-radius:10px; cursor:pointer;
  }
  .sources{
    position:fixed; right:12px; bottom:12px; z-index:12;
    border:none; background:transparent; cursor:pointer;
    font-family:"Great Vibes", cursive; font-size:28px; color:#ffb3b3; text-shadow:0 2px 8px rgba(0,0,0,.7);
  }

  /* Sources overlay */
  #sourcesPane{
    position:fixed; inset:0; display:none; z-index:30; background:rgba(0,0,0,.88);
  }
  .sources-wrap{
    max-width:min(1000px,92vw); margin:6vh auto; background:var(--panel);
    border:1px solid var(--border); border-radius:18px; padding:22px 22px 10px;
    box-shadow:var(--shadow); height:88vh; overflow:auto;
  }
  .sources-wrap h2{
    text-align:center; margin:4px 0 14px; color:#ffbebe; font-weight:700;
  }
  .sources-wrap ul{list-style:none; padding:0; margin:0}
  .sources-wrap li{margin:10px 0 16px; line-height:1.5}
  .closeX{
    position:sticky; top:6px; float:right; margin-right:-8px;
    font-size:22px; background:none; color:#ffbebe; border:none; cursor:pointer;
  }
  .sources-wrap a{color:#9ec5ff; text-decoration:none}
  .sources-wrap a:hover{text-decoration:underline}
</style>
</head>
<body>

<!-- HOME -->
<section id="home" aria-label="Homepage">
  <div class="home-overlay" aria-hidden="true"></div>
  <div class="home-card">
    <h1 class="home-title">The Roman Pantheon</h1>
    <p class="home-sub">An immersive, AP-level guided tour</p>
    <!-- MLA header -->
    <div class="mla">
      Amogh Bhat<br/>
      Mr. Loggins<br/>
      Period 3<br/>
      17 October 2025
    </div><br/>
    <button id="begin" class="home-btn">Begin Tour of Pantheon</button>
    <div class="hint">Press <strong>Space</strong> to advance • <strong>Backspace</strong> to go back</div>
  </div>
</section>

<!-- APP -->
<main id="app" aria-live="polite">
  <div class="progress" id="progress">1 / 14</div>
  <button id="prev" class="navbtn" aria-label="Previous slide">⟵</button>
  <button id="next" class="navbtn" aria-label="Next slide">⟶</button>
</main>

<!-- Controls -->
<button class="audio" id="audioToggle" aria-label="Pause or play background music">⏸︎ Music</button>
<button class="sources" id="sourcesBtn" aria-label="Open sources used">Sources Used</button>

<!-- Background music (public-domain, instrumental) -->
<audio id="bgm" preload="auto" loop>
  <source src="https://commons.wikimedia.org/wiki/Special:FilePath/The%20Washington%20Post%20-%20Ceremonial%20Brass%20-%20United%20States%20Air%20Force%20Band.mp3" type="audio/mpeg">
  <source src="https://commons.wikimedia.org/wiki/Special:FilePath/The%20Washington%20Post%20-%20Ceremonial%20Brass%20-%20United%20States%20Air%20Force%20Band.ogg" type="audio/ogg">
</audio>

<!-- Sources pane -->
<aside id="sourcesPane" role="dialog" aria-modal="true" aria-labelledby="srcTitle">
  <div class="sources-wrap">
    <button class="closeX" id="closeSources" title="Close">✕</button>
    <h2 id="srcTitle">Sources Used — MLA</h2>
    <ul>
      <!-- Core references -->
      <li>The Editors of <em>Encyclopaedia Britannica</em>. “Pantheon.” <em>Britannica</em>, 29 July 2025. <a href="https://www.britannica.com/topic/Pantheon-building-Rome-Italy">https://www.britannica.com/topic/Pantheon-building-Rome-Italy</a>.</li>
      <li>Harris, Beth, and Steven Zucker. “The Pantheon (Rome).” <em>Smarthistory</em>. <a href="https://smarthistory.org/the-pantheon/">https://smarthistory.org/the-pantheon/</a>.</li>
      <li>Pantheon Roma. “History of the Pantheon in Rome and Curiosities to Discover.” <em>PantheonRoma.com</em>. <a href="https://www.pantheonroma.com/pantheon-history/">https://www.pantheonroma.com/pantheon-history/</a>.</li>
      <li>Rome Tourism Board. “The Pantheon.” <em>Turismo Roma</em>. <a href="https://www.turismoroma.it/en/places/pantheon">https://www.turismoroma.it/en/places/pantheon</a>.</li>
      <li>Hannah, Robert, and Giulio Magli. “The Role of the Sun in the Pantheon’s Design and Meaning.” <em>Numen</em> 58.4 (2011): 486–513. Preprint, arXiv, 2009. <a href="https://arxiv.org/abs/0910.0128">https://arxiv.org/abs/0910.0128</a>.</li>
      <li>“Pantheon, Rome.” <em>Wikipedia</em>, 2025. <a href="https://en.wikipedia.org/wiki/Pantheon,_Rome">https://en.wikipedia.org/wiki/Pantheon,_Rome</a>.</li>
      <li>ArcheoRoma. “Pantheon, Rome: History and Description.” <em>ArcheoRoma</em>. <a href="https://www.archeoroma.org/sites/pantheon/">https://www.archeoroma.org/sites/pantheon/</a>.</li>

      <!-- Video (silent background) -->
      <li>ZDF Terra X. <em>Ausdehnung des römischen Reiches</em>. 29 Nov. 2021. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Ausdehnung_des_r%C3%B6mischen_Reiches.webm">commons.wikimedia.org/wiki/File:Ausdehnung_des_römischen_Reiches.webm</a>.</li>

      <!-- Images (Wikimedia Commons) -->
      <li>Reusch, Pascal. <em>Pantheon and Fountain at Night</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Pantheon_and_fountain_at_night.JPG">commons.wikimedia.org/wiki/File:Pantheon_and_fountain_at_night.JPG</a>.</li>
      <li>daniele_malavolta. <em>Rome Pantheon Facade and Piazza della Rotonda</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Rome_Pantheon_facade_and_Piazza_della_Rotonda.jpg">commons.wikimedia.org/wiki/File:Rome_Pantheon_facade_and_Piazza_della_Rotonda.jpg</a>.</li>
      <li>Wknight94. <em>Pantheon (Rome) Entrance Door</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Pantheon_(Rome)_entrance_door.jpg">commons.wikimedia.org/wiki/File:Pantheon_(Rome)_entrance_door.jpg</a>.</li>
      <li>Livioandronico2013. <em>Pantheon Interior</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Pantheon_interior_(45696759504).jpg">commons.wikimedia.org/wiki/File:Pantheon_interior_(45696759504).jpg</a>.</li>
      <li>Sund, Sheila. <em>Pantheon, Rome with Oculus Lighting</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Pantheon,_Rome_with_oculus_lighting_(8404115660).jpg">commons.wikimedia.org/wiki/File:Pantheon,_Rome_with_oculus_lighting_(8404115660).jpg</a>.</li>
      <li>Perfect Tommy. <em>Pantheon Floor Drainage</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Pantheon_floor_drainage.jpg">commons.wikimedia.org/wiki/File:Pantheon_floor_drainage.jpg</a>.</li>
      <li>John Samuel. <em>Pantheon — Interior 03</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Pantheon_(Rome)_-_Interior_03.jpg">commons.wikimedia.org/wiki/File:Pantheon_(Rome)_-_Interior_03.jpg</a>.</li>
      <li>Anthony M. <em>Pantheon Dome (Exterior)</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Pantheon_dome.jpg">commons.wikimedia.org/wiki/File:Pantheon_dome.jpg</a>.</li>
      <li>Paolo Rosa. <em>Panteon Oculus Light</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:Panteon_oculus_light.JPG">commons.wikimedia.org/wiki/File:Panteon_oculus_light.JPG</a>.</li>
      <li>Ank Kumar. <em>The Tomb of Raphael in the Pantheon</em>. <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:The_tomb_of_Raphael_in_the_Pantheon_in_Rome,_Italy_(Ank_Kumar)_06.jpg">commons.wikimedia.org/wiki/File:The_tomb_of_Raphael_in_the_Pantheon_in_Rome,_Italy_(Ank_Kumar)_06.jpg</a>.</li>

      <!-- Audio -->
      <li>United States Air Force Band. “The Washington Post — Ceremonial Brass.” <em>Wikimedia Commons</em>. <a href="https://commons.wikimedia.org/wiki/File:The_Washington_Post_-_Ceremonial_Brass_-_United_States_Air_Force_Band.mp3">commons.wikimedia.org/wiki/File:The_Washington_Post_-_Ceremonial_Brass_-_United_States_Air_Force_Band.mp3</a>.</li>
    </ul>
  </div>
</aside>

<script>
/* ========= UTIL ========= */
const IMG = (file) => `https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(file)}?width=1920`;

/* ========= TOUR CONTENT =========
   Added a new first slide with a silent background VIDEO.
   'side' places the text panel left/right so the image remains visible. */
const slides = [
  /* PROLOGUE: video background */
  {
    type: "video",
    title: "Prologue — Rome, ‘All the Gods,’ and a New Architecture",
    side: "right",
    video: "https://commons.wikimedia.org/wiki/Special:FilePath/Ausdehnung%20des%20r%C3%B6mischen%20Reiches.webm",
    para: "Pantheon literally joins Greek roots—pan (all) + theoi (gods)—into a Roman statement of universal power. The temple we see is Hadrianic (c. 118–128 CE), yet it preserves Agrippa’s inscription from Augustus’ age. Greeks gave the orders and pediment; Romans fused that classical language to concrete technology, creating a spherical interior unknown to Greece.",
    bullets: [
      "Origins: Agrippa’s Pantheon (27–25 BCE) in the Campus Martius; later fires (80 and c.110 CE) led to a complete Hadrianic rebuild.",
      "Meaning: a house for ‘all gods’ and imperial ideology—cosmos and state in one room.",
      "Style: Greek portico + Roman rotunda; Corinthian order up front, concrete revolution within.",
      "People: Augustus and Agrippa (founders); Trajan’s era initiates works; Hadrian likely oversees design; ancient sources mention Apollodorus, but authorship is debated.",
      "Site: flood-prone Campus Martius—former parade ground; alignment dramatizes the sun’s path through the oculus."
    ]
  },

  {
    title: "Piazza della Rotonda — First Glimpse",
    img: IMG("Pantheon and fountain at night.JPG"),
    side: "left",
    para: "Fountain, obelisk, and temple front compose a ceremonial approach. The portico frames the city; beyond it, a hidden rotunda holds the surprise.",
    bullets: [
      "Form: rectangle before circle—an intentional reveal from open square to enclosed cosmos.",
      "Greek legacy: columnar facade and pediment announce classical piety.",
      "Urban history: square reshaped in the Renaissance/Baroque to foreground the porch."
    ]
  },
  {
    title: "Facade & Inscription — Agrippa Remembered",
    img: IMG("Rome Pantheon facade and Piazza della Rotonda.jpg"),
    side: "right",
    para: "The entablature reads M·AGRIPPA·L·F·COS·TERTIVM·FECIT. Hadrian keeps the Augustan credit, binding present emperor to a golden past.",
    bullets: [
      "Chronology: Agrippa’s temple (27–25 BCE) ➝ burned 80 CE ➝ restored ➝ burned c.110 CE ➝ Hadrianic rebuild c.118–128 CE.",
      "Columns: 16 in total (8 across the front; two rows of 4) of Egyptian granite—imperial logistics via Nile and Mediterranean.",
      "Purpose: a ‘pantheon’—possibly for all gods or imperial cult; exact original rites remain debated."
    ]
  },
  {
    title: "Bronze Doors — Ritual Threshold",
    img: IMG("Pantheon (Rome) entrance door.jpg"),
    side: "left",
    para: "Monumental bronze leaves pivot into shadow. Crossing them shifts us from Rome’s bustle into a uniquely Roman space of geometry and light.",
    bullets: [
      "Medium: bronze doors; stone portico; brick-faced concrete for the rotunda.",
      "Technique: precision hinges and ancient metalwork—surviving in use for centuries.",
      "Experience: sound mutes, temperature cools—architecture as stagecraft."
    ]
  },
  {
    title: "A Perfect Interior — The 43.3 m Sphere",
    img: IMG("Pantheon_interior_(45696759504).jpg"),
    side: "right",
    para: "Height to oculus equals diameter of the floor (≈43.3 m). A virtual sphere fits inside—cosmic order expressed as habitable volume.",
    bullets: [
      "Composition: paired Corinthian columns articulate seven bays; rich marble revetments form bands of color.",
      "Greek vs Roman: Greek temples privilege exterior; Rome turns grandeur inward.",
      "Meaning: the ruler stands at the center of measured heavens—order made visible."
    ]
  },
  {
    title: "Oculus — Architecture of Light",
    img: IMG("Pantheon,_Rome_with_oculus_lighting_(8404115660).jpg"),
    side: "left",
    para: "A 9 m-wide opening (≈30 Roman feet) admits sky, sun, rain. A moving beam canonizes whichever surface it touches.",
    bullets: [
      "Coffers: five rings, diminishing upward—optical rhythm, mass reduction.",
      "Solar drama: seasonal alignments at noon tie civic ritual to cosmic time.",
      "Philosophy: a dialogue between material dome and immaterial heavens."
    ]
  },
  {
    title: "Floor & Drains — Let the Rain In",
    img: IMG("Pantheon_floor_drainage.jpg"),
    side: "right",
    para: "Rain falls freely; the floor’s subtle convexity and discreet outlets channel it away. Nature is integrated, not excluded.",
    bullets: [
      "Engineering: ~22 drainage holes beneath patterned marble handle storms.",
      "Design: circles and squares tessellate the pavement—geometry you can walk on."
    ]
  },
  {
    title: "Materials & Making — Concrete Alchemy",
    img: IMG("Pantheon_(Rome)_-_Interior_03.jpg"),
    side: "left",
    para: "Roman builders grade the concrete: heavy aggregates below, lighter toward the crown—travertine ➝ tufa ➝ pumice.",
    bullets: [
      "Walls: ~6 m thick drum conceals relieving arches that redirect thrust into piers.",
      "Finish: porphyry, giallo antico, pavonazzetto—empire-wide logistics in stone.",
      "Technique: cast in lifts with wooden centering; coffers lighten and pattern."
    ]
  },
  {
    title: "Dome Outside — Discipline of Mass",
    img: IMG("Pantheon_dome.jpg"),
    side: "right",
    para: "From the street, the dome reads as low and earthy, its ribs faint. The exterior’s understatement masks radical interior space.",
    bullets: [
      "Structure: compressive shell crowned by the oculus; thrust resolved by the drum.",
      "Legacy: world’s largest unreinforced concrete dome—an unbeaten ancient record."
    ]
  },
  {
    title: "Air, Weather, and Time",
    img: IMG("Panteon_oculus_light.JPG"),
    side: "left",
    para: "Breeze, rain, and the daily arc of the sun animate the architecture. Time itself becomes a material in the room.",
    bullets: [
      "Ritual: the sunbeam often greets entrants at noon—choreographed revelation.",
      "Audience: orientation, awe, and a recalibration of human scale."
    ]
  },
  {
    title: "Temple Becomes Church (609 CE)",
    img: IMG("Pantheon_interior_(45696759504).jpg"),
    side: "right",
    para: "Consecrated as Santa Maria ad Martyres, the Pantheon survives through use. Pagan form receives Christian liturgy without losing its cosmic stage.",
    bullets: [
      "Continuity: relics translated; altars inserted; processions replace sacrifices.",
      "Urban fate: church status spared it the spoliation that ruined many temples."
    ]
  },
  {
    title: "Raphael and the Kings",
    img: IMG("The_tomb_of_Raphael_in_the_Pantheon_in_Rome,_Italy_(Ank_Kumar)_06.jpg"),
    side: "left",
    para: "Raphael chose to rest here; modern Italy’s kings did too. Art, nation, and antiquity share one ceremonial shell.",
    bullets: [
      "Raphael’s epitaph: Nature feared being outdone by him in life—and to die with him.",
      "Civic shrine: royal tombs bind national identity to an ancient monument."
    ]
  },
  {
    title: "Losses & Afterlives",
    img: IMG("Pantheon_(Rome)_-_Interior_03.jpg"),
    side: "right",
    para: "Bronze once glittered in the portico’s coffers; later ages reused it for cannons and St. Peter’s. Yet the Pantheon’s essential ideas endure.",
    bullets: [
      "Barberini tale: “What the barbarians did not do, the Barberini did.”",
      "Influence: from Brunelleschi’s Florence to the U.S. Capitol and beyond."
    ]
  },
  {
    title: "Return to the Square",
    img: IMG("Rome_Pantheon_facade_and_Piazza_della_Rotonda.jpg"),
    side: "left",
    para: "Obelisk and fountain draw us back into Rome. The porch invites; the rotunda keeps its celestial secret—ever ready to astonish the next generation.",
    bullets: [
      "Synthesis recap: Form, Content, Style, Medium, Technique, POV, and Legacy fuse into living architecture.",
      "Takeaway: Greek language of orders + Roman concrete imagination = a building for all time."
    ]
  }
];

/* ========= RENDER ========= */
const app = document.getElementById('app');
const progressEl = document.getElementById('progress');

function makeImageSlide(s){
  const el = document.createElement('section');
  el.className = 'slide';
  el.style.backgroundImage = `url("${s.img}")`;

  const panel = document.createElement('article');
  panel.className = `panel ${s.side||'right'}`;
  panel.innerHTML = `
      <h2 class="title">${s.title}</h2>
      <p class="para">${s.para}</p>
      ${s.bullets?.length ? `<ul class="bullets">${s.bullets.map(b=>`<li>${b}</li>`).join('')}</ul>` : ``}
  `;
  el.appendChild(panel);
  return el;
}

function makeVideoSlide(s){
  const el = document.createElement('section');
  el.className = 'slide';
  const wrap = document.createElement('div');
  wrap.className = 'vid-wrap';
  const v = document.createElement('video');
  v.src = s.video;
  v.muted = true; v.autoplay = true; v.loop = true; v.playsInline = true;
  v.setAttribute('preload','auto');
  wrap.appendChild(v);
  const scrim = document.createElement('div'); scrim.className = 'vid-scrim';
  wrap.appendChild(scrim);
  el.appendChild(wrap);

  const panel = document.createElement('article');
  panel.className = `panel ${s.side||'right'}`;
  panel.innerHTML = `
      <h2 class="title">${s.title}</h2>
      <p class="para">${s.para}</p>
      ${s.bullets?.length ? `<ul class="bullets">${s.bullets.map(b=>`<li>${b}</li>`).join('')}</ul>` : ``}
  `;
  el.appendChild(panel);
  return el;
}

function makeSlide(s){
  return s.type === 'video' ? makeVideoSlide(s) : makeImageSlide(s);
}

slides.forEach(s=> app.appendChild(makeSlide(s)));

const slideEls = [...document.querySelectorAll('.slide')];
let i = 0;
const total = slideEls.length;
const progress = ()=> progressEl.textContent = `${i+1} / ${total}`;

function show(n){
  if(n<0||n>=total||n===i) return;
  slideEls[i].classList.remove('active');
  slideEls[n].classList.add('active');
  i = n; progress();
}
function next(){ if(i<total-1) show(i+1); }
function prev(){ if(i>0) show(i-1); }

/* ========= HOME & AUDIO ========= */
const begin = document.getElementById('begin');
const home = document.getElementById('home');
const appRoot = document.getElementById('app');
const bgm = document.getElementById('bgm');
const audioToggle = document.getElementById('audioToggle');

begin.addEventListener('click', async ()=>{
  home.style.display='none';
  appRoot.style.display='block';
  slideEls[0].classList.add('active');
  progress();
  try { await bgm.play(); audioToggle.textContent='⏸︎ Music'; } catch(e){ audioToggle.textContent='▶︎ Music'; }
});

document.getElementById('next').onclick = next;
document.getElementById('prev').onclick = prev;

document.addEventListener('keydown', (e)=>{
  if(sourcesOpen) return;
  if(e.code==='Space'){ e.preventDefault(); next(); }
  else if(e.code==='Backspace'){ e.preventDefault(); prev(); }
  else if(e.code==='ArrowRight'){ next(); }
  else if(e.code==='ArrowLeft'){ prev(); }
});

audioToggle.addEventListener('click', async ()=>{
  if(bgm.paused){ await bgm.play(); audioToggle.textContent='⏸︎ Music'; }
  else{ bgm.pause(); audioToggle.textContent='▶︎ Music'; }
});

/* ========= SOURCES PANEL ========= */
const sourcesBtn = document.getElementById('sourcesBtn');
const sourcesPane = document.getElementById('sourcesPane');
const closeSources = document.getElementById('closeSources');
let sourcesOpen=false;
sourcesBtn.onclick = ()=>{ sourcesPane.style.display='block'; sourcesOpen=true; };
closeSources.onclick = ()=>{ sourcesPane.style.display='none'; sourcesOpen=false; };

/* ========= PRELOAD IMAGES ========= */
slides.filter(s=>s.img).forEach(s=>{ const im=new Image(); im.src=s.img; });
</script>
</body>
</html>
